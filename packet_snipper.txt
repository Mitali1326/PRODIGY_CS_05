from scapy.all import sniff, IP, TCP, UDP, Raw

def process_packet(packet):
    if IP in packet:
        src_ip = packet[IP].src
        dst_ip = packet[IP].dst
        proto = packet[IP].proto

        if TCP in packet:
            protocol = "TCP"
        elif UDP in packet:
            protocol = "UDP"
        else:
            protocol = "Other"

        print(f"ğŸ“¦ Protocol: {protocol}")
        print(f"ğŸ”µ Source IP: {src_ip}")
        print(f"ğŸ”´ Destination IP: {dst_ip}")

        # Print payload if present
        if Raw in packet:
            payload = packet[Raw].load
            try:
                print(f"ğŸ“© Payload: {payload.decode(errors='ignore')}")
            except:
                print("ğŸ“© Payload: [Unreadable binary data]")

        print("-" * 60)

print("ğŸ” Starting Comillas Negras Packet Sniffer (Press Ctrl+C to stop)...")

# Start sniffing
sniff(prn=process_packet, store=False)
